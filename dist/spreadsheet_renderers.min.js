function callWithJQuery(e){"object"==typeof exports&&"object"==typeof module?e(require("jquery"),require("exceljs")):"function"==typeof define&&define.amd?define(["jquery","exceljs"],e):e(jQuery,ExcelJS)}let createWorkBookXLSX=(e,o={creator:"nu-pivottables"})=>{e=new e.Workbook;return e.creator=o.creator,e},addWorkSheetToWorkBookXLSX=(e,o)=>e.addWorksheet(o),addRowsToWorksheet=(e,o)=>(e.addRows(o),e),addPivotTableToWorksheet=(e,{sourceSheet:o,rows:t,columns:r,values:a,metric:s="sum"})=>e.addPivotTable({sourceSheet:o,rows:t,columns:r,values:a,metric:s}),workbookToXLSXFile=async e=>{try{return await e.xlsx.writeBuffer()}catch(e){throw new Error("Error while writing to the XLSX file: ",e)}},columnsFromObjectInput=e=>Object.keys(e[0]).map(e=>({header:e,key:e})),pivotValues=e=>e?.rowAttrs.length?[e.rowAttrs[0]]:e?.colAttrs.length?[e.colAttrs[0]]:void 0,createXLSXFile=async(e,o)=>{try{var t=o.input,r=createWorkBookXLSX(e),a=addWorkSheetToWorkBookXLSX(r,"Full Data"),s=(a.columns=columnsFromObjectInput(t),addRowsToWorksheet(a,t),addWorkSheetToWorkBookXLSX(r,"Pivot table")),l=(addPivotTableToWorksheet(s,{sourceSheet:a,rows:o.rowAttrs??[],columns:o.colAttrs??[],values:pivotValues(o),metric:"sum"}),await workbookToXLSXFile(r));return new Blob([l],{type:"application/octet-stream"})}catch(e){console.error(e)}},createDownloadLink=(e,o,t)=>{var e=URL.createObjectURL(e),r=document.createElement("a");return r.textContent=t.localeStrings.exportXLSX,r.href=e,r.download=o,r},makeXLSXExport=(t,r)=>async(e,o)=>{defaults={localeStrings:{exportXLSX:"Export XLSX"}},o=t.extend(!0,{},defaults,o);e=await createXLSXFile(r,e),e=createDownloadLink(e,"nu-pivottables-export.xlsx",o);return t("<div>").addClass("spreadsheet-downloads").append(e)};callWithJQuery((e,o)=>{e.pivotUtilities.spreadsheet_renderers={"XLSX export":makeXLSXExport(e,o)}});